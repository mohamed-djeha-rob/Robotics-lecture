\usepackage[bigfiles]{pdfbase}
\usepackage{xkeyval} % For handling key-value pairs

\makeatletter
\define@boolkey{embedvideo}{autoplay}{\def\embedvideoautoplay{#1}}
\define@boolkey{embedvideo}{showGUI}{\def\embedvideoshowGUI{#1}}
\presetkeys{embedvideo}{autoplay=true,showGUI=true}{}

\ExplSyntaxOn

\NewDocumentCommand\embedvideo{smmO{autoplay=true,showGUI=true}}{
  \group_begin:
  \leavevmode

  % Parse the options (autoplay, showGUI)
  \setkeys{embedvideo}{#4}

  \tl_if_exist:cTF{file_\file_mdfive_hash:n{#3}}{
    \tl_set_eq:Nc\video{file_\file_mdfive_hash:n{#3}}
  }{
    \IfFileExists{#3}{}{\GenericError{}{File~`#3'~not~found}{}{}}
    \pbs_pdfobj:nnn{}{fstream}{{}{#3}}
    \pbs_pdfobj:nnn{}{dict}{
      /Type/Filespec/F~(#3)/UF~(#3)
      /EF~<</F~\pbs_pdflastobj:>>
    }
    \tl_set:Nx\video{\pbs_pdflastobj:}
    \tl_gset_eq:cN{file_\file_mdfive_hash:n{#3}}\video}

  % Define the video parameters with the GUI and autoplay options
  \pbs_pdfobj:nnn{}{dict}{
    /Type/RichMediaInstance/Subtype/Video
    /Asset~\video/Params~<</FlashVars (source=#3&
      skinAutoHide=\embedvideoshowGUI&
      skin= skin1&
      controlBarMode=floating&
      controls=\embedvideoshowGUI&
      skinBackgroundColor=0x5F5F5F&
      skinBackgroundAlpha=0&
      speed=10&
      loop=true&
      volume=100&
      replay=true&
      stop=true&
      navigationSlider=true&
      autoplay=\embedvideoautoplay)>>
  }

  \pbs_pdfobj:nnn{}{dict}{
    /Type/RichMediaConfiguration/Subtype/Video
    /Instances~[\pbs_pdflastobj:]
  }

  \pbs_pdfobj:nnn{}{dict}{
    /Type/RichMediaContent
    /Assets~<<
      /Names~[(#3)~\video]
    >>
    /Configurations~[\pbs_pdflastobj:]
  }

  \tl_set:Nx\rmcontent{\pbs_pdflastobj:}

  \pbs_pdfobj:nnn{}{dict}{
    /Activation~<<
      /Condition/\IfBooleanTF{#1}{PV}{XA}
      /Presentation~<</Style/Embedded>>
    >>
    /Deactivation~<</Condition/PI>>
  }

  \hbox_set:Nn\l_tmpa_box{#2}
  \tl_set:Nx\l_box_wd_tl{\dim_use:N\box_wd:N\l_tmpa_box}
  \tl_set:Nx\l_box_ht_tl{\dim_use:N\box_ht:N\l_tmpa_box}
  \tl_set:Nx\l_box_dp_tl{\dim_use:N\box_dp:N\l_tmpa_box}
  \pbs_pdfxform:nnnnn{1}{1}{}{}{\l_tmpa_box}

  \pbs_pdfannot:nnnn{\l_box_wd_tl}{\l_box_ht_tl}{\l_box_dp_tl}{
    /Subtype/RichMedia
    /BS~<</W~0/S/S>>
    /Contents~(embedded~video~file:#3)
    /NM~(rma:#3)
    /AP~<</N~\pbs_pdflastxform:>>
    /RichMediaSettings~\pbs_pdflastobj:
    /RichMediaContent~\rmcontent}
  \phantom{#2}
  \group_end:
}

\ExplSyntaxOff
\makeatother
